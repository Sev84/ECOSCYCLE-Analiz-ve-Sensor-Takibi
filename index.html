<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECOSCYCLE - Akıllı Kontrol Paneli</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Source+Code+Pro:wght@400;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Tone.js for Sound Effects -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <style>
        :root {
            --primary-color: #27ae60; --warning-color: #f39c12; --critical-color: #e74c3c;
            --light-theme-bg: #f7fdf9; --dark-text: #34495e; --card-bg: rgba(255, 255, 255, 0.8);
            --card-shadow: rgba(46, 204, 113, 0.1); --nav-bg: #ffffff; --nav-text-color: #34495e; 
            --info-color: #3498db; --border-color: rgba(0, 0, 0, 0.1);
        }
        *, *::before, *::after { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body, html {
            margin: 0; padding: 0; font-family: 'Poppins', sans-serif; height: 100%;
            overflow-x: hidden; color: var(--dark-text); background-color: #e6f9f0;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%23ffffff' fill-opacity='1' d='M0,128L48,138.7C96,149,192,171,288,170.7C384,171,480,149,576,122.7C672,96,768,64,864,80C960,96,1056,160,1152,176C1248,192,1344,160,1392,144L1440,128L1440,0L1392,0C1344,0,1248,0,1152,0C1056,0,960,0,864,0C768,0,672,0,576,0C480,0,384,0,288,0C192,0,96,0,48,0L0,0Z'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: top; background-size: 100% 400px;
        }
        .main-container { display: flex; flex-direction: column; height: 100vh; background-color: transparent; }
        .top-nav { display: flex; align-items: center; padding: 0 30px; background-color: var(--nav-bg); border-bottom: 1px solid var(--border-color); position: fixed; top: 0; left: 0; right: 0; z-index: 1000; box-shadow: 0 2px 10px var(--card-shadow); }
        .logo-container { display: flex; align-items: center; gap: 15px; }
        .logo-container .svg-logo { width: 45px; height: auto; }
        .logo-container h1 { font-size: 1.5em; margin: 0; color: var(--nav-text-color); }
        .nav-tabs { margin: 0 auto; overflow-x: auto; white-space: nowrap;}
        .nav-tabs .nav-link { background: none; border: none; color: var(--nav-text-color); padding: 20px 25px; font-size: 1em; cursor: pointer; text-decoration: none; position: relative; transition: color 0.3s; display: inline-block; opacity: 0.7;}
        .nav-tabs .nav-link::after { content: ''; position: absolute; bottom: 0; left: 50%; width: 0; height: 3px; background-color: var(--primary-color); transition: all 0.3s ease-in-out; }
        .nav-tabs .nav-link.active, .nav-tabs .nav-link:hover { color: var(--dark-text); opacity: 1; }
        .nav-tabs .nav-link.active::after { width: 100%; left: 0; }
        .top-nav-actions { display: flex; align-items: center; gap: 20px; }
        .action-btn { background: none; border: none; color: var(--nav-text-color); font-size: 1.5em; cursor: pointer; transition: color 0.3s; opacity: 0.8; }
        .action-btn:hover { color: var(--primary-color); opacity: 1; }
        .content-area { padding: 30px; padding-top: 100px; }
        .content-section { min-height: 90vh; padding: 50px 0; border-bottom: 1px solid var(--border-color); display: flex; flex-direction: column; justify-content: center; }
        .content-section:last-child { border-bottom: none; }
        .section-title { font-size: 2.5em; color: var(--primary-color); text-align: center; margin-bottom: 40px; }
        .overview-layout { display: flex; align-items: center; gap: 50px; width: 100%; max-width: 1200px; margin: 0 auto; }
        .overview-info { flex: 1.2; }
        .overview-info .section-title { text-align: left; font-size: 3em; }
        .overview-info p.subtitle { font-size: 1.2em; opacity: 0.7; margin-top: -30px; margin-bottom: 30px; }
        .overview-image { flex: 1; text-align: center; }
        .overview-image .mobile-ui-svg { max-width: 350px; height: auto; filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1)); }
        .overview-info .card { background-color: var(--card-bg); backdrop-filter: blur(5px); }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px; }
        .card { background-color: var(--card-bg); padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px var(--card-shadow); backdrop-filter: blur(10px); }
        .card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px; font-size: 1.2em; font-weight: 600; }
        .card-header .title { display: flex; align-items: center; }
        .card-header .title i { margin-right: 15px; width: 25px; text-align: center; color: var(--primary-color); }
        .sensor-value { font-size: 2.5em; font-weight: 700; text-align: center; }
        .sensor-value .unit { font-size: 0.5em; font-weight: 400; margin-left: 5px; }
        .chart-container { position: relative; height: 120px; margin-top: 20px; }
        .info-page h3 { color: var(--info-color); margin-top: 30px; }
        .info-page p { line-height: 1.7; text-align: justify; opacity: 0.9; }
        .info-page ul { list-style-type: none; padding-left: 0; }
        .info-page ul li { background-color: rgba(255,255,255,0.5); margin-bottom: 10px; padding: 15px; border-left: 4px solid var(--primary-color); border-radius: 5px; }
        .info-images { display: flex; gap: 20px; margin-top: 20px; flex-wrap: wrap; justify-content: center; align-items: center; }
        .info-images .svg-container { text-align:center; width: 100%; max-width: 280px; height: 200px; padding:15px; background-color:rgba(255,255,255,0.6); border-radius:10px;}
        .info-images .svg-container svg { height: 100%; width: auto;}
        .water-volume-card { display: flex; justify-content: space-around; text-align: center;}
        .volume-item p { margin: 0; opacity: 0.7;}
        .volume-item .sensor-value { font-size: 2em; }
        .alert { display: flex; align-items: center; padding: 15px; border-radius: 10px; display: none; }
        .alert.show { display: flex; }
        .alert-red { background-color: #fce8e6; border-left: 5px solid var(--critical-color); color: var(--critical-color); }
        .alert-yellow { background-color: #fff8e1; border-left: 5px solid var(--warning-color); color: var(--warning-color); }
        .alert-green { background-color: #e6f4ea; border-left: 5px solid var(--primary-color); color: var(--primary-color); }
        .alert i { font-size: 1.5em; margin-right: 15px; }
        .alert p { margin: 0; font-weight: 500; }
        .risk-gauges-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; align-items: stretch; margin-top: 30px; }
        .gauge-card { text-align: center; padding: 20px; }
        .gauge-container { position: relative; width: 180px; height: 90px; margin: 20px auto 0 auto; overflow: hidden; }
        .gauge-semi-circle { position: absolute; top: 0; left: 0; width: 180px; height: 180px; border: 20px solid #eee; border-radius: 50%; border-bottom-color: transparent; border-right-color: transparent; transform: rotate(-45deg); }
        .gauge-mask { position: absolute; top: 0; left: 0; width: 180px; height: 90px; background: var(--card-bg); }
        .gauge-needle { position: absolute; bottom: 0; left: 50%; width: 2px; height: 90px; background: var(--dark-text); transform-origin: bottom center; transition: transform 0.5s ease; }
        .gauge-value { font-size: 2em; font-weight: 700; margin-top: -50px; z-index: 1; position: relative; }
        .gauge-text { font-size: 1em; opacity: 0.8; z-index: 1; position: relative; }
        .gauge-card .card-header { justify-content: center; font-size: 1.1em;}
        #bluetooth-connecting-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.85); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 2000; }
        #bluetooth-connecting-overlay.active { display: flex; }
        .bt-spinner { font-size: 5em; color: var(--info-color); animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.2); opacity: 0.7; } }
        #bluetooth-connecting-overlay p { font-size: 1.5em; margin-top: 20px; color: white; }
        #terminal { background-color: #1a1a1a; padding: 40px 20px; border-radius: 15px; margin-top: 20px; }
        .terminal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--primary-color); padding-bottom: 10px; margin-bottom: 10px; }
        .terminal-title { font-size: 1.5em; color: var(--primary-color); text-shadow: 0 0 5px var(--primary-color); }
        #terminal-output { height: 400px; overflow-y: auto; white-space: pre-wrap; word-wrap: break-word; font-family: 'Source Code Pro', monospace; color: #00ff00; }
        #terminal-output::-webkit-scrollbar { width: 8px; } #terminal-output::-webkit-scrollbar-track { background: #222; } #terminal-output::-webkit-scrollbar-thumb { background: var(--primary-color); }
        #back-to-top-btn { position: fixed; bottom: 30px; right: 30px; width: 50px; height: 50px; background-color: var(--primary-color); color: white; border: none; border-radius: 50%; font-size: 1.5em; cursor: pointer; display: none; justify-content: center; align-items: center; box-shadow: 0 4px 10px rgba(0,0,0,0.3); transition: opacity 0.3s, transform 0.3s; z-index: 999; }
        #back-to-top-btn.visible { display: flex; opacity: 1; }
        
        @media (max-width: 1024px) { .overview-layout { flex-direction: column; text-align: center; } .overview-info .section-title { text-align: center; } .overview-image { margin-top: 30px; } }
        @media (max-width: 768px) { .top-nav { flex-direction: column; padding: 10px; height: auto; } .nav-tabs { width: 100%; overflow-x: auto; } .content-area { padding-top: 150px; } }
    </style>
</head>
<body>
    <div class="main-container">
        <header class="top-nav">
            <div class="logo-container">
                <img class="svg-logo" src="data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3Cpath id='arrow' d='M50,0 L65,20 L35,20 Z'/%3E%3C/defs%3E%3Ccircle cx='50' cy='50' r='20' fill='%233498db'/%3E%3Cuse href='%23arrow' fill='%232ecc71' transform='rotate(0, 50, 50) translate(0, -35)'/%3E%3Cuse href='%23arrow' fill='%232ecc71' transform='rotate(120, 50, 50) translate(0, -35)'/%3E%3Cuse href='%23arrow' fill='%232ecc71' transform='rotate(240, 50, 50) translate(0, -35)'/%3E%3C/svg%3E" alt="logo1111.png">
                <h1>ECOSCYCLE</h1>
            </div>
            <nav class="nav-tabs">
                 <a href="#overview" class="nav-link active">Genel Bakış</a>
                <a href="#status" class="nav-link">Sistem Uyarıları</a>
                <a href="#graphs" class="nav-link">Anlık Grafikler</a>
                <a href="#about" class="nav-link">Hakkımızda</a>
                <a href="#weather" class="nav-link">Bölgesel Risk Analizi</a>
            </nav>
            <div class="top-nav-actions">
                <button id="bluetooth-terminal-btn" class="action-btn"><i class="fa-brands fa-bluetooth-b"></i></button>
            </div>
        </header>

        <main class="content-area">
            <section id="overview" class="content-section">
                 <div class="overview-layout">
                    <div class="overview-info">
                        <h2 class="section-title">Akıllı Şehirler İçin Ekolojik Çözümler</h2>
                        <p class="subtitle">ECOSCYCLE, şehirlerimizi iklim değişikliğine karşı daha dirençli hale getirmeyi amaçlayan akıllı bir su ve hava yönetimi sistemidir.</p>
                        <div class="card">
                            <div class="card-header"><div class="title"><i class="fa-solid fa-water"></i><span>Sistem Su Hacmi</span></div></div>
                            <div class="water-volume-card">
                                <div class="volume-item">
                                    <p>Yağmur Bahçesi</p>
                                    <div class="sensor-value" id="rain-garden-volume">2.0 L</div>
                                </div>
                                <div class="volume-item">
                                    <p>Mikroalg Reaktörü</p>
                                    <div class="sensor-value" id="microalgae-volume">1.0 L</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="overview-image">
                        <img src="https://i.imgur.com/bQk0M9i.png" alt="Mobil Arayüz Görünümü" onerror="this.onerror=null;this.src='https://placehold.co/400x800/e6f9f0/34495e?text=Mobil+Aray%C3%BCz';">
                    </div>
                </div>
            </section>
            
            <section id="status" class="content-section">
                <h2 class="section-title">Sistem Uyarıları</h2>
                <div id="status-alerts" class="card">
                    <div id="alert-soil" class="alert alert-red">
                        <i class="fas fa-exclamation-circle"></i>
                        <p>Toprak kuru, sulama sistemi devreye alınmalı.</p>
                    </div>
                     <div id="alert-light" class="alert alert-yellow">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Işık seviyesi yetersiz, fotosentez verimi düşebilir.</p>
                    </div>
                     <div id="alert-temp" class="alert alert-red">
                        <i class="fas fa-exclamation-circle"></i>
                        <p>Sıcaklık kritik seviyede yüksek, sistem kontrol ediliyor.</p>
                    </div>
                    <div id="alert-ok" class="alert alert-green">
                        <i class="fas fa-check-circle"></i>
                        <p>Tüm koşullar ideal, sistem stabil çalışıyor.</p>
                    </div>
                </div>
            </section>
            
            <section id="graphs" class="content-section">
                <h2 class="section-title">Anlık Veri Takibi</h2>
                <div class="grid-container">
                    <div class="card"><div class="card-header"><div class="title"><i class="fas fa-sun"></i><span>Işık Şiddeti</span></div></div><div class="card-body"><div class="sensor-value" id="light-value">--</div><div class="chart-container"><canvas id="light-chart"></canvas></div></div></div>
                    <div class="card"><div class="card-header"><div class="title"><i class="fas fa-tint"></i><span>Toprak Nemi</span></div></div><div class="card-body"><div class="sensor-value" id="humidity-value">--</div><div class="chart-container"><canvas id="humidity-chart"></canvas></div></div></div>
                    <div class="card"><div class="card-header"><div class="title"><i class="fas fa-thermometer-half"></i><span>Ortam Sıcaklığı</span></div></div><div class="card-body"><div class="sensor-value" id="temperature-value">--</div><div class="chart-container"><canvas id="temperature-chart"></canvas></div></div></div>
                    <div class="card"><div class="card-header"><div class="title"><i class="fas fa-wind"></i><span>Hava Kalitesi</span></div></div><div class="card-body"><div class="sensor-value" id="air-quality-value">--</div><div class="chart-container"><canvas id="air-quality-chart"></canvas></div></div></div>
                </div>
            </section>

            <section id="how-to" class="content-section info-page">
                <h2 class="section-title">Nasıl Kullanılır?</h2>
                <div class="info-images">
                     <div class="svg-container">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><defs><linearGradient id="a" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#88f"/><stop offset="100%" stop-color="#66f"/></linearGradient></defs><path fill="#c7ecee" d="M100 130a45 45 0 00-45 45v5h90v-5a45 45 0 00-45-45z"/><path fill="url(#a)" d="M100 130a45 45 0 0145 45v-5a40 40 0 00-80 0v5a45 45 0 0135-45z"/><path fill="#9bceb7" d="M57 140a3 3 0 11-6 0 3 3 0 016 0zm9 13a3 3 0 11-6 0 3 3 0 016 0zm14-5a3 3 0 11-6 0 3 3 0 016 0zm11 11a3 3 0 11-6 0 3 3 0 016 0zm12-7a3 3 0 11-6 0 3 3 0 016 0zm10 9a3 3 0 11-6 0 3 3 0 016 0zm-60-3a4 4 0 11-8 0 4 4 0 018 0zm11 14a4 4 0 11-8 0 4 4 0 018 0zm13-6a4 4 0 11-8 0 4 4 0 018 0zm12 12a4 4 0 11-8 0 4 4 0 018 0zm11-4a4 4 0 11-8 0 4 4 0 018 0zm12 10a4 4 0 11-8 0 4 4 0 018 0z"/><path fill="#fff" d="M60 20 L 140 20 L 140 130 L 60 130 Z" opacity="0.2" rx="10"/><path fill="none" stroke="#66f" stroke-width="4" d="M100 20v110" stroke-linecap="round"/><path fill="#66f" d="M100 20l-15 15h30l-15-15z M100 130l-15-15h30l-15 15z"/><text x="110" y="80" font-family="Poppins" font-size="12" fill="#333">CO2</text><text x="80" y="80" font-family="Poppins" font-size="12" fill="#333" text-anchor="end">O2</text></svg>
                        <p style="margin-top:5px; font-size:0.9em; opacity:0.8;">Biyoreaktör</p>
                    </div>
                    <div class="svg-container">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><path fill="#b08968" d="M0 160h200v20H0z"/><path fill="#8c6a4d" d="M0 140h200v20H0z"/><path fill="#e0ac69" d="M0 120h200v20H0z"/><path fill="#2ecc71" d="M50 120 l-10 -20 h20z m40 0 l-10 -30 h20z m60 0 l-10 -25 h20z "/><path fill="#27ae60" d="M30 120 l-10-25 h20z m70 0 l-10 -20 h20z m50 0 l-10-35 h20z"/><path fill="none" stroke="#3498db" stroke-width="3" stroke-dasharray="5 5" d="M40 40v80m120-80v80m-60-90v90"/><path fill="#3498db" d="M40 40l-10 10h20z m120 0l-10 10h20z m-60-10l-10 10h20z"/></svg>
                        <p style="margin-top:5px; font-size:0.9em; opacity:0.8;">Yağmur Bahçesi</p>
                    </div>
                </div>
            </section>
            
            <section id="about" class="content-section info-page">
                <h2 class="section-title">Projenin Amaç ve Hedefleri</h2>
                <ul>
                    <li><b>Şehirlerde Su Yönetimini İyileştirmek:</b> Yağmur suyunu kontrollü bir şekilde toplayarak, arıtarak ve yeniden kullanarak sel riskini azaltmak ve su kaynaklarında verimlilik sağlamak.</li>
                    <li><b>Hava Kirliliğini Azaltmak:</b> Mikroalglerin fotosentetik gücünden faydalanarak havadaki karbon emisyonlarını düşürmek ve kentsel alanlarda oksijen üretimini artırarak daha sağlıklı yaşam alanları oluşturmak.</li>
                    <li><b>Akıllı ve Otomatik Kontrol Sağlamak:</b> IoT sensörleri ile toprak nemi, su akışı ve hava kalitesi gibi kritik verileri anlık olarak takip edip, sistemi en verimli şekilde otomatik olarak yönetmek.</li>
                    <li><b>Yeşil Altyapıyı Güçlendirmek:</b> Kentsel biyoçeşitliliği korumak, şehirlerin ekolojik direncini artırmak ve doğayla uyumlu, sürdürülebilir kalkınma hedeflerine ulaşmayı teşvik etmek.</li>
                </ul>
            </section>

             <section id="weather" class="content-section">
                <h2 class="section-title" id="weather-location-title">Bölgesel Risk Analizi <small>Konum verisi bekleniyor...</small></h2>
                <div class="risk-gauges-grid">
                    <div class="card gauge-card"><div class="card-header"><i class="fas fa-cloud-showers-heavy"></i><span>Sel Riski</span></div><div class="gauge-container"><div class="gauge-semi-circle"></div><div class="gauge-needle" id="gauge-flood"></div><div class="gauge-mask"></div></div><div class="gauge-value" id="value-flood">--%</div><div class="gauge-text" id="text-flood">--</div></div>
                    <div class="card gauge-card"><div class="card-header"><i class="fas fa-sun-plant-wilt"></i><span>Kuraklık Riski</span></div><div class="gauge-container"><div class="gauge-semi-circle"></div><div class="gauge-needle" id="gauge-drought"></div><div class="gauge-mask"></div></div><div class="gauge-value" id="value-drought">--%</div><div class="gauge-text" id="text-drought">--</div></div>
                    <div class="card gauge-card"><div class="card-header"><i class="fas fa-tint"></i><span>Nem Doygunluğu</span></div><div class="gauge-container"><div class="gauge-semi-circle"></div><div class="gauge-needle" id="gauge-humidity"></div><div class="gauge-mask"></div></div><div class="gauge-value" id="value-humidity">--%</div><div class="gauge-text" id="text-humidity">--</div></div>
                    <div class="card gauge-card"><div class="card-header"><i class="fas fa-lungs"></i><span>Oksijen Seviyesi</span></div><div class="gauge-container"><div class="gauge-semi-circle"></div><div class="gauge-needle" id="gauge-oxygen"></div><div class="gauge-mask"></div></div><div class="gauge-value" id="value-oxygen">--%</div><div class="gauge-text" id="text-oxygen">--</div></div>
                </div>
            </section>
            
            <section id="terminal" class="content-section">
                 <div class="terminal-header"><div class="terminal-title">ECO-S-ELNSOR // MOBIL TERMINAL</div></div>
                <pre id="terminal-output"></pre>
            </section>
        </main>
    </div>

    <div id="bluetooth-connecting-overlay">
        <i class="fa-brands fa-bluetooth-b bt-spinner"></i>
        <p>Mobil Terminale Bağlanılıyor...</p>
    </div>

    <a href="#overview" id="back-to-top-btn"><i class="fa-solid fa-arrow-up"></i></a>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

        document.addEventListener('DOMContentLoaded', () => {
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            const btConnectingOverlay = document.getElementById('bluetooth-connecting-overlay');
            const btTerminalBtn = document.getElementById('bluetooth-terminal-btn');
            const backToTopBtn = document.getElementById('back-to-top-btn');
            const mainContentArea = document.querySelector('.main-container');

            navLinks.forEach(link => { link.addEventListener('click', e => { e.preventDefault(); document.querySelector(link.getAttribute('href')).scrollIntoView({ behavior: 'smooth' }); }); });
            
            function onScroll() {
                let currentSectionId = '';
                contentSections.forEach(section => { if (mainContentArea.scrollTop >= section.offsetTop - 150) { currentSectionId = section.getAttribute('id'); } });
                navLinks.forEach(link => { link.classList.remove('active'); if (link.getAttribute('href') === `#${currentSectionId}`) { link.classList.add('active'); } });
                if (mainContentArea.scrollTop > 300) { backToTopBtn.style.display = 'flex'; } else { backToTopBtn.style.display = 'none'; }
            }
            mainContentArea.addEventListener('scroll', onScroll);

            btTerminalBtn.addEventListener('click', () => {
                btConnectingOverlay.classList.add('active');
                setTimeout(() => {
                    btConnectingOverlay.classList.remove('active');
                    document.getElementById('terminal').scrollIntoView({ behavior: 'smooth' });
                }, 2500);
            });
        
            function initializeDashboard() {
                const terminalOutput = document.getElementById('terminal-output');
                function writeToTerminal(message) { terminalOutput.innerHTML += message + '\n'; terminalOutput.scrollTop = terminalOutput.scrollHeight; }

                const lightValueEl = document.getElementById('light-value'), humidityValueEl = document.getElementById('humidity-value'), temperatureValueEl = document.getElementById('temperature-value'), airQualityValueEl = document.getElementById('air-quality-value');
                const alertSoil = document.getElementById('alert-soil'), alertLight = document.getElementById('alert-light'), alertTemp = document.getElementById('alert-temp'), alertOk = document.getElementById('alert-ok');
                
                let chartInstances = {};
                function createChart(ctx, color) { return new Chart(ctx, { type: 'line', data: { labels: [], datasets: [{ data: [], borderColor: color, borderWidth: 2.5, fill: true, backgroundColor: 'rgba(44, 62, 80, 0.1)', tension: 0.4, pointRadius: 0 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } } } }); }
                if(document.getElementById('light-chart')) chartInstances.light = createChart(document.getElementById('light-chart').getContext('2d'), '#f1c40f');
                if(document.getElementById('humidity-chart')) chartInstances.humidity = createChart(document.getElementById('humidity-chart').getContext('2d'), '#3498db');
                if(document.getElementById('temperature-chart')) chartInstances.temperature = createChart(document.getElementById('temperature-chart').getContext('2d'), '#e74c3c');
                if(document.getElementById('air-quality-chart')) chartInstances.airQuality = createChart(document.getElementById('air-quality-chart').getContext('2d'), '#9b59b6');

                function updateChart(chart, label, newData) { if(!chart) return; chart.data.labels.push(label); chart.data.datasets[0].data.push(newData); if (chart.data.labels.length > 15) { chart.data.labels.shift(); chart.data.datasets[0].data.shift(); } chart.update('none'); }
                
                const rainGardenVolumeEl = document.getElementById('rain-garden-volume');
                const microalgaeVolumeEl = document.getElementById('microalgae-volume');
                rainGardenVolumeEl.textContent = '2.0 L';
                microalgaeVolumeEl.textContent = '1.0 L';

                function updateAll(sensorData) {
                    if (!sensorData) return;
                    const now = new Date();
                    const timeLabel = `${now.getHours()}:${now.getMinutes().toString().padStart(2,'0')}:${now.getSeconds().toString().padStart(2,'0')}`;
                    
                    lightValueEl.innerHTML = `${sensorData.light}<span class="unit"></span>`; updateChart(chartInstances.light, timeLabel, sensorData.light);
                    humidityValueEl.innerHTML = `${sensorData.soil}<span class="unit"></span>`; updateChart(chartInstances.humidity, timeLabel, sensorData.soil);
                    temperatureValueEl.innerHTML = `${sensorData.temperature.toFixed(1)}<span class="unit">°C</span>`; updateChart(chartInstances.temperature, timeLabel, sensorData.temperature);
                    airQualityValueEl.innerHTML = `${sensorData.airQuality}<span class="unit"></span>`; updateChart(chartInstances.airQuality, timeLabel, sensorData.airQuality);
                    
                    let isProblemFound = false;
                    let terminalMessage = "Tüm koşullar ideal.";
                    alertSoil.classList.remove('show');
                    alertLight.classList.remove('show');
                    alertTemp.classList.remove('show');
                    alertOk.classList.remove('show');

                    if (sensorData.soil <= 1200) {
                        alertSoil.classList.add('show');
                        isProblemFound = true;
                        terminalMessage = "UYARI: Toprak Kuru!";
                    }
                    if (sensorData.light <= 1200) {
                        alertLight.classList.add('show');
                        isProblemFound = true;
                        terminalMessage = (terminalMessage === "Tüm koşullar ideal." ? "" : terminalMessage + " ") + "Işık Yetersiz!";
                    }
                    if (sensorData.temperature >= 30) {
                        alertTemp.classList.add('show');
                        isProblemFound = true;
                        terminalMessage = (terminalMessage === "Tüm koşullar ideal." ? "" : terminalMessage + " ") + "Sıcaklık Yüksek!";
                    }
                    if (!isProblemFound) {
                        alertOk.classList.add('show');
                    }
                    
                    writeToTerminal(`<span style="color:#888">[${timeLabel}]</span> [DURUM] ${terminalMessage}`);
                }
                
                writeToTerminal("ECO-S-ELNSOR Web Arayüzü v11.0 başlatılıyor...");
                setInterval(() => {
                    const simulatedData = { light: Math.floor(Math.random() * 4096), soil: Math.floor(Math.random() * 4096), temperature: (Math.random() * 20 + 15), airQuality: Math.floor(Math.random() * 2000) };
                    updateAll(simulatedData);
                }, 3000);
            }
            
            initializeDashboard();
        });
    </script>
</body>
</html>
